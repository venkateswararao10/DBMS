insert update and delete


select to_date((to_char(stdate,'dd-mm')||'-'||'2019'),'dd-mm-yyyy') from batches;

TO_DATE((
---------
12-JAN-19
15-JAN-19
20-JAN-19
02-MAR-19
05-APR-19
12-JUL-19
15-AUG-19

7 rows selected.

q1 ans:

SQL> update courses set fee=fee+10000 where ccode in (select ccode from batches group by ccode having count(bcode)=2 );

1 row updated.

SQL> select * from courses;

CCODE NAME                             DURATION        FEE
----- ------------------------------ ---------- ----------
PREREQUISITE
--------------------------------------------------------------------------------
ora   oracle database                        12     264500
windows

vbnet vb.net                                 12     305500
windows and programming

c     c programming                          12     203500
computer awareness


CCODE NAME                             DURATION        FEE
----- ------------------------------ ---------- ----------
PREREQUISITE
--------------------------------------------------------------------------------
asp   asp.net                                12     255500
internet and programming

java  java language                          12     254500
c language

xml   xml programming                        12     154000
html,scripting,asp/jsp


6 rows selected.

SQL> rollback;

Rollback complete.

SQL> select * from courses;

CCODE NAME                             DURATION        FEE
----- ------------------------------ ---------- ----------
PREREQUISITE
--------------------------------------------------------------------------------
ora   oracle database                        12     254500
windows

vbnet vb.net                                 12     305500
windows and programming

c     c programming                          12     203500
computer awareness


CCODE NAME                             DURATION        FEE
----- ------------------------------ ---------- ----------
PREREQUISITE
--------------------------------------------------------------------------------
asp   asp.net                                12     255500
internet and programming

java  java language                          12     254500
c language

xml   xml programming                        12     154000
html,scripting,asp/jsp


6 rows selected.


q2 ans:
SQL> delete from batches where bcode not in (select bcode from students);

2 rows deleted.

SQL> select bcode from batches;

BCODE
-----
b1
b2
b3
b4
b5

SQL> select bcode from students;

BCODE
-----
b1
b1
b2
b2
b2
b3
b3
b4
b5
b5
b5

11 rows selected.

SQL> rollback;

Rollback complete.

SQL> select * from batches;

BCODE CCODE FACCO STDATE    ENDDATE       TIMING
----- ----- ----- --------- --------- ----------
b1    ora   gk    12-JAN-21 20-FEB-21          1
b2    asp   da    15-JAN-21 05-MAR-21          2
b3    c     hs    20-JAN-21 27-FEB-21          3
b4    xml   dh    02-MAR-21 30-MAR-21          3
b5    java  hs    05-APR-21 10-MAY-21          1
b6    vbnet da    12-JUL-21                    1
b7    ora   jc    15-AUG-21                    2

7 rows selected.


q3 ans:
SQL> update batches set faccode=(select faccode from batches where bcode='b1') where bcode='b7';

1 row updated.

SQL> select * from batches;

BCODE CCODE FACCO STDATE    ENDDATE       TIMING
----- ----- ----- --------- --------- ----------
b1    ora   gk    12-JAN-21 20-FEB-21          1
b2    asp   da    15-JAN-21 05-MAR-21          2
b3    c     hs    20-JAN-21 27-FEB-21          3
b4    xml   dh    02-MAR-21 30-MAR-21          3
b5    java  hs    05-APR-21 10-MAY-21          1
b6    vbnet da    12-JUL-21                    1
b7    ora   gk    15-AUG-21                    2

7 rows selected.

SQL> rollback;

Rollback complete.

SQL> select * from batches;

BCODE CCODE FACCO STDATE    ENDDATE       TIMING
----- ----- ----- --------- --------- ----------
b1    ora   gk    12-JAN-21 20-FEB-21          1
b2    asp   da    15-JAN-21 05-MAR-21          2
b3    c     hs    20-JAN-21 27-FEB-21          3
b4    xml   dh    02-MAR-21 30-MAR-21          3
b5    java  hs    05-APR-21 10-MAY-21          1
b6    vbnet da    12-JUL-21                    1
b7    ora   jc    15-AUG-21                    2

7 rows selected.

q4 ans:

SQL> select * from batches;

BCODE CCODE FACCO STDATE    ENDDATE       TIMING
----- ----- ----- --------- --------- ----------
b1    ora   gk    12-JAN-21 20-FEB-21          1
b2    asp   da    15-JAN-21 05-MAR-21          2
b3    c     hs    20-JAN-21 27-FEB-21          3
b4    xml   dh    02-MAR-21 30-MAR-21          3
b5    java  hs    05-APR-21 10-MAY-21          1
b6    vbnet da    12-JUL-21                    1
b7    ora   jc    15-AUG-21                    2

7 rows selected.

SQL> update batches set stdate=add_months(stdate,-24),enddate=add_months(stdate,-24)  where enddate is not null;

5 rows updated.

SQL> select * from batches;

BCODE CCODE FACCO STDATE    ENDDATE       TIMING
----- ----- ----- --------- --------- ----------
b1    ora   gk    12-JAN-19 12-JAN-19          1
b2    asp   da    15-JAN-19 15-JAN-19          2
b3    c     hs    20-JAN-19 20-JAN-19          3
b4    xml   dh    02-MAR-19 02-MAR-19          3
b5    java  hs    05-APR-19 05-APR-19          1
b6    vbnet da    12-JUL-21                    1
b7    ora   jc    15-AUG-21                    2

7 rows selected.

SQL> rollback;

Rollback complete.

SQL> update batches set stdate=add_months(stdate,-24);

7 rows updated.

SQL> select * from batches;

BCODE CCODE FACCO STDATE    ENDDATE       TIMING
----- ----- ----- --------- --------- ----------
b1    ora   gk    12-JAN-19 20-FEB-21          1
b2    asp   da    15-JAN-19 05-MAR-21          2
b3    c     hs    20-JAN-19 27-FEB-21          3
b4    xml   dh    02-MAR-19 30-MAR-21          3
b5    java  hs    05-APR-19 10-MAY-21          1
b6    vbnet da    12-JUL-19                    1
b7    ora   jc    15-AUG-19                    2

7 rows selected.

SQL> rollback;

Rollback complete.

SQL> update batches set enddate=add_months(stdate,-24) where enddate is not null;
update batches set enddate=add_months(stdate,-24) where enddate is not null
*
ERROR at line 1:
ORA-02290: check constraint (SYSTEM.CHKDATE) violated


SQL> update batches set enddate=add_months(enddate,-24) where enddate is not null;
update batches set enddate=add_months(enddate,-24) where enddate is not null
*
ERROR at line 1:
ORA-02290: check constraint (SYSTEM.CHKDATE) violated

q5 ans:

SQL> update students set dj=add_months(dj,-24) where dj is not null;

11 rows updated.

SQL> select * from students;

    ROLLNO BCODE NAME                           G DJ        PHONE
---------- ----- ------------------------------ - --------- ----------
EMAIL
------------------------------
         1 b1    george micheal                 m 10-JAN-19 488333
gm@yahoo.com

         2 b1    micheal douglas                m 11-JAN-19 348333
md@gmail.com

         3 b2    andy roberts                   m 11-JAN-19 433554
ar@yahoo.com


    ROLLNO BCODE NAME                           G DJ        PHONE
---------- ----- ------------------------------ - --------- ----------
EMAIL
------------------------------
         4 b2    malcom marshall                m 16-JAN-19 653345
mm@usa.net

         5 b2    vivan richards                 m 16-JAN-19 641238
vr@yahoo.com

         6 b3    chirs evert                    f 14-JAN-19
ce@yahoo.com


    ROLLNO BCODE NAME                           G DJ        PHONE
---------- ----- ------------------------------ - --------- ----------
EMAIL
------------------------------
         7 b3    ivan lendal                    m 15-JAN-19 431212
il@gmail.com

         8 b4    george micheal                 m 01-MAR-19 488333
gm@gmail.com

         9 b5    richard marx                   m 06-APR-19 876567
rm@gmail.com


    ROLLNO BCODE NAME                           G DJ        PHONE
---------- ----- ------------------------------ - --------- ----------
EMAIL
------------------------------
        10 b5    tina turner                    f 06-APR-19 565678
tinat@gmail.com

        11 b5    jody foster                    f 07-APR-19 234344
jody@hotmail.com


11 rows selected.

SQL> rollback;

Rollback complete.

SQL>

group by having aggregate

q2 ans:

SQL> select count(rollno),bcode from students group by(bcode) order by bcode;

COUNT(ROLLNO) BCODE
------------- -----
            2 b1
            3 b2
            2 b3
            1 b4
            3 b5

q3 ans:

SQL> select sum(amount),rollno from payments group by(rollno);

SUM(AMOUNT)     ROLLNO
----------- ----------
       4500          1
       4500          2
       5000          4
       5000          3
